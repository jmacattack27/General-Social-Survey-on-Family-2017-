---
title: "My title"
subtitle: "My subtitle if needed"
author: 
  - First author
  - Another author
thanks: "Code and data are available at: https://github.com/jmacattack27/General-Social-Survey-on-Family-2017- ."
date: "`r format(Sys.time(), '%d %B %Y')`"
abstract: "First sentence. Second sentence. Third sentence. Fourth sentence."
output:
  bookdown::pdf_document2
toc: FALSE
bibliography: references.bib
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)

# Load libraries
library(tidyverse)
library(kableExtra)
library(patchwork)

# Read in data
raw_data <- read_csv(here::here("inputs/data/AAae9eTh.csv"))
gss_data <- read_csv(here::here("inputs/data/gss.csv"))

```

# Introduction

Canada’s General Social Survey (GSS) program is a series of independent, annual, cross sectional surveys on a variety of topics, such as families, caregiving and social identity, with each survey covering one topic in depth. As well as collecting information on the given topic, each survey also collects comprehensive socio-demographic data, recording respondents age, sex, education, religion, etc. Established in 1985, the GSS program was founded with 2 primary objectives:
To gather data on social trends as they evolve over time, in order to monitor changes in the living conditions and lifestyle of Canadians, and
To provide information on specific social policy issues of current or emerging interest
In these regards, the GSS program has been largely successful, with GSS data often serving as evidence behind key government programs designed to improve the well-being of Canadians. As well, GSS data has also informed research about the social lives of Canadians, and continues to serve as a valuable training tool for quantitative and statistical methods in post-secondary institutions across the country (believe it or not). For these reasons, the GSS program serves an important and foundational role within Canada's national statistical system. 

The General Social Survey on Family monitors trends and changes in Canadian families. Family is the single most important influence in a child's life; our family shapes our lives, influencing every aspect of our lives. Indeed, a strong, supportive family is the best and most foundational support a person can have. The GSS on Family aims to provide the government with an accurate picture of the diversity, demographics and trends of Canadian families. The data collected will help guide lawmakers in designing social programs and policies that will best serve the needs of millions of Canadian families. Hence, the GSS on Family is foundational in helping Canadian families, and therefore plays a key role in helping new Canadians have a healthy and functional support system. In this sense, the GSS is helping usher new generations of Canadians into as good a world as possible, and thus plays a critical role in the continued prosperity of Canada.

In this paper, we show a snapshot of what Canadian families look like using data from the 2017 General Social Survey on Family. Specifically, we address the following research questions:

- What are the most common family sizes and types (e.g. married couple, single-parent, etc.)?
- Do most Canadians get married and how many children do they have?
- What is distribution of education level of Canadians?
- Are Canadian households mainly low-income, middle-income or high-income?
- Which provinces have the most immigrant families?
- Is religion important in Canadian families?
- What is the mental health of Canadians like, and what factors may be related to this?


# Data

## Data Source and Methodology

The data was obtained from Canada's 2017 General Social Survey (GSS) on the Family. The survey was conducted during the period of February 2nd to November 30th 2017 by computer assisted telephone interviews of participants. The target population was all non-institutionalized persons ages 15 years and older in Canada, excluding residents of the Yukon, Northwest Territories, and Nunavut. Participants were chosen using stratified sampling by geographic area within the 10 provinces, with one person representing each household to be interviewed. The response rate was 52.4% with a total of 20,602 respondents.

Data collected by the GSS is categorized further into 2 components; core content and classification variables. Core content consists of data designed to measure social trends and living conditions, as well as to inform specific policy issues. Examples of core content include questions such as "Are parents satisfied with the child care services they are receiving?" and "How many parents are taking leave for the birth of their child?" Classification variables on the other hand refer to the variables used to collect the aforementioned socio-demographic data. These include age, sex, religion and education of the respondent, and are used to help accurately portray respondent populations, with the goal of helping in the analysis of core content. Below is a brief outline of the questionnaire content on the 2017 GSS on Family:

  - Entry component (respondent’s date of birth) 
  - Family origins 
  - Leaving the parental home 
  - Conjugal history 
  - Intentions and reasons to form a union 
  - Respondent’s children 
  - Fertility intentions 
  - Maternity/parental leave 
  - Organization and decision making within the household 
  - Arrangements and financial support after a separation/divorce 
  - Labour market new and education 
  - Health and subjective well-being 
  - Characteristics of respondent’s dwelling 
  - Characteristics of respondent of spouse/partner


## Survey Frame

As previously mentioned, participants of this survey were chosen via stratified sampling wherein each province was divided into strata. Most Census Metropolitan Areas (CMAs) were considered separate strata, while the remaining CMAs were grouped together and divided into 3 separate strata. In total there were 27 strata used for sampling. 

The survey frame was then created using 2 main components:
Lists of telephone numbers, both home lines and cellular, that were available to Statistics Canada, and
The Address Register (AR), a list of all the dwellings within the 10 provinces. 

One person was surveyed per household; thus the Address Register was used to group together phone numbers by address. Approximately 86% of telephone numbers were linked to an address via the AR. These numbers, as well as the remaining 14% of unlinked numbers, were then combined to create the sampling frame. When multiple phone numbers were linked to the same address, these numbers were then sorted by type of number, with landlines first and cellular numbers last. The first number was then considered the best number to reach that household; recall that we want to survey households, not individuals, and so landlines were prioritized over cellular numbers. Note that as a result of the cellular surveying method, households without a telephone were excluded from the survey frame. 

For the 2017 GSS, 91.8% of the selected telephone numbers reached eligible households. To be eligible, a household had to include at least one person 15 years of age or older. During collection, households that did not meet the eligibility criteria were terminated after an initial set of questions. A respondent was then randomly selected from each household to participate in a telephone interview.


## Sampling Methods

Each phone number / group of phone numbers (which we will henceforth refer to as “records”) was then sorted into its corresponding geographical strata, at which point a simple random sample without replacement was then performed on each strata. Approximately 91.8% of telephone numbers selected in the sample reached an eligible household (an eligible household being defined as a household that included at least one person 15 years of age or older). Data on households that did not meet the eligibility requirements was not included in the results, and phone calls with such households were terminated. 


## Key features

The raw data includes 461 variables which were derived from the questionnaire responses. Some key features included age, sex, place of birth, marriage, ethnic diversity and immigration, education, work, income, children, religion, family structure, geographic location, household size and living arrangements. We used R [@citeR] and R packages tidyverse [@tidy] and janitor [@janitor] to clean the variable names and values. A subset of the key features is shown in table \@ref(tab:datafeatures).

```{r datafeatures, echo=FALSE, message=FALSE}
gss_data %>%
  select(age, total_children, sex, province, marital_status, income_family) %>%
  slice(1:10) %>%
  kable(
    caption = "Some key features",
    col.names = c("Age of respondent", "Total number of children", "Sex", "Province", "Marital Status", "Family Income"),
    digits = 1,
    booktabs = TRUE, 
    linesep = ""
  ) %>%
column_spec(1:2, width = "2.5cm")
```



## Strengths and weaknesses

```{r, include=FALSE}
# Check missing values
colSums(is.na(gss_data)) # https://stackoverflow.com/questions/24027605/determine-the-number-of-na-values-in-a-column
```

Strengths include that there is a large number of variables so there is a lot of opportunity for data exploration and research insights, and there is also a large number of observations for us to draw meaningful conclusions. A weakness includes that response categories for some of the questionnaire questions were collapsed in the code variables provided, for example mother tongue only lists English, French and non-official languages, and race of respondent became visible minority (yes/no), so we cannot comment on the full range of diverse responses.

# Results

```{r householdwrangling, include=FALSE, message=FALSE, warning=FALSE}

# Data wrangling for household
household_data <- raw_data %>%
  select(hsdsizec, famtype) %>%
  mutate(household_size = case_when(hsdsizec == 6 ~ "6+",
                                    TRUE ~ as.character(hsdsizec)), 
         family_type = case_when(famtype == 1 ~ "Couple",
                                 famtype == 2 ~ "Intact family*",
                                 famtype == 3 ~ "Step-family with common child",
                                 famtype == 4 ~ "Step-family without a common child",
                                 famtype == 5 ~ "Single-parent family",
                                 famtype == 6 ~ "No spouse/partner or children in the
household"))

# get percents of each household size
household_percents <- household_data %>%
  group_by(household_size) %>%
  summarise(percent = 100*n()/nrow(household_data))

# 5+ people in a houshold percentage
five_plus_households <- household_percents %>%
  filter(household_size >= 5) %>%
  select(percent) %>%
  summarise(total_percent = sum(percent))

```


Figure \@ref(fig:householdsize) shows the distribution of household sizes with family type. The most common household sizes are 1 and 2-person, so Canadians generally live alone or in a romantic relationship. For household sizes greater than 2, they are mostly nuclear families, with 3-4 persons. Only `r round(five_plus_households$total_percent, 2)`% of households have 5 or more people living together. 

```{r householdsize, echo=FALSE, message=FALSE, warning=FALSE, fig.cap="Distribution of family type by household size"}

# Plot for household size
household_data %>%
  ggplot(aes(x = household_size, fill = family_type)) +
  geom_bar() +
  scale_fill_brewer(palette = "Set1") +
  scale_y_continuous(breaks = seq(0, 8000, by = 1000)) +
  theme_minimal() +
  theme(panel.grid.major.x = element_blank(), panel.grid.minor.x = element_blank()) +
  labs(x = "Household size",
       y = "Number of responses",
       fill = "Family Type",
       caption = "*Intact family = family in which both biological\nparents are present in the home.")


```

## Marriage and Children

```{r numchildrenwrangling, include=FALSE, message=FALSE, warning=FALSE}

# Data wrangling for total number of children
child_data <- gss_data %>%
  mutate(total_children1 = case_when(total_children == 7 ~ "7+",
                                     TRUE ~ as.character(total_children)
                                     ))
# get percents of each number
child_percents <- child_data %>%
  group_by(total_children1) %>%
  summarise(percent = 100*n()/nrow(child_data))

# 5+ people in a houshold percentage
zero_children <- child_percents %>%
  filter(total_children1 == 0) %>%
  select(percent) %>%
  summarise(total_percent = sum(percent))

```

Figure \@ref(fig:numchildren) shows the distribution of the total number of children per family. Note that this is not *per household* i.e. persons living together, but the number of children ever had by the respondent of the household. The two tallest bars of nearly equal height are for 0 and 2 children, followed by 1 and 3 children also being similar in frequency, but about half as much as for 0 and 2. Thus, `r round(zero_children$total_percent,2)`% Canadians do not have any children and those who do usually have 1-3 children. 

```{r numchildren, echo=FALSE, message=FALSE, warning=FALSE, fig.cap="Distribution of total number of children per family"}
# Plot for total number of children
child_data %>%
  select(total_children1) %>%
  ggplot(aes(x = total_children1)) +
  geom_bar(fill = "#377EB8") +
  scale_y_continuous(breaks = seq(0, 7000, by = 1000)) +
  theme_minimal() +
  theme(panel.grid.major.x = element_blank(), panel.grid.minor.x = element_blank()) +
  labs(title = "Distribution of total number of children per family",
       x = "Number of children",
       y = "Number of responses")
```

Figure \@ref(fig:agemarbirth) shows the distributions of the age of respondents when they first got married and had children.

```{r agemarbirth, echo=FALSE, message=FALSE, warning=FALSE, fig.cap="Distribution of ages at marriage and birth"}
# Plot for age at first marriage
marriage_plot<- gss_data %>%
  # mutate(age_at_first_marriage = round(age_at_first_marriage)) %>%
  select(age_at_first_marriage) %>%
  ggplot(aes(x = age_at_first_marriage)) +
  geom_histogram(bins = 65, fill = "#E41A1C") +
  scale_x_continuous(limits = c(15, 50),breaks = seq(0, 50, by = 10)) +
  scale_y_continuous(limits = c(0, 600),breaks = seq(0, 800, by = 100)) +
  theme_minimal() +
  theme(panel.grid.major.x = element_blank(), panel.grid.minor.x = element_blank()) +
  labs(title = "A. Distribution of age at first marriage",
       x = "Age at first marriage",
       y = "Number of responses")

# Plot for age at first birth
first_birth_plot <- gss_data %>%
  # mutate(age_at_first_birth = round(age_at_first_birth)) %>%
  select(age_at_first_birth) %>%
  ggplot(aes(x = age_at_first_birth)) +
  geom_histogram(bins = 65, fill = "#4DAF4A") +
 scale_x_continuous(limits = c(15, 50), breaks = seq(0, 50, by = 10)) +
  scale_y_continuous(limits = c(0, 600),breaks = seq(0, 800, by = 100)) +
  theme_minimal() +
  theme(panel.grid.major.x = element_blank(), panel.grid.minor.x = element_blank()) +
  labs(title = "B. Distribution of age at first birth",
       x = "Age at first birth",
       y = "Number of responses")

marriage_plot / first_birth_plot

```



# Discussion

## First discussion point

If my paper were 10 pages, then should be be at least 2.5 pages. The discussion is a chance to show off what you know and what you learnt from all this. 

## Second discussion point

## Third discussion point

## Weaknesses and next steps

Weaknesses and next steps should also be included.

\newpage

\appendix

# Appendix {-}


# Additional details


\newpage


# References


