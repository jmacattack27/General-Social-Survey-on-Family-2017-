---
title: "My title"
subtitle: "My subtitle if needed"
author: 
  - Kimlin Chin
  - Jack McKay
  - Jacob Yoke Hong Si
thanks: "Code and data are available at: https://github.com/jmacattack27/General-Social-Survey-on-Family-2017- ."
date: "`r format(Sys.time(), '%d %B %Y')`"
abstract: "First sentence. Second sentence. Third sentence. Fourth sentence."
output:
  bookdown::pdf_document2
toc: FALSE
bibliography: references.bib
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
# Load libraries
#install.packages('patchwork')
#install.packages('mapcan')
library(tidyverse)
library(kableExtra)
library(patchwork)
library(mapcan)
# Read in data
raw_data <- read_csv(here::here("inputs/data/AAae9eTh.csv"))
gss_data <- read_csv(here::here("inputs/data/gss.csv"))
```

# Introduction

Canada’s General Social Survey (GSS) program is a series of independent, annual, cross sectional surveys on a variety of topics, such as families, caregiving and social identity, with each survey covering one topic in depth. As well as collecting information on the given topic, each survey also collects comprehensive socio-demographic data, recording respondents age, sex, education, religion, etc. Established in 1985, the GSS program was founded with 2 primary objectives:
To gather data on social trends as they evolve over time, in order to monitor changes in the living conditions and lifestyle of Canadians, and 
To provide information on specific social policy issues of current or emerging interest
In these regards, the GSS program has been largely successful, with GSS data often serving as evidence behind key government programs designed to improve the well-being of Canadians. As well, GSS data has also informed research about the social lives of Canadians, and continues to serve as a valuable training tool for quantitative and statistical methods in post-secondary institutions across the country (believe it or not). For these reasons, the GSS program serves an important and foundational role within Canada's national statistical system. 

The General Social Survey on Family monitors trends and changes in Canadian families. Family is the single most important influence in a child's life; our family shapes our lives, influencing every aspect of our lives. Indeed, a strong, supportive family is the best and most foundational support a person can have. The GSS on Family aims to provide the government with an accurate picture of the diversity, demographics and trends of Canadian families. The data collected will help guide lawmakers in designing social programs and policies that will best serve the needs of millions of Canadian families. Hence, the GSS on Family is foundational in helping Canadian families, and therefore plays a key role in helping new Canadians have a healthy and functional support system. In this sense, the GSS is helping usher new generations of Canadians into as good a world as possible, and thus plays a critical role in the continued prosperity of Canada.

In this paper, we view a snapshot of what Canadian families look like using data from the 2017 General Social Survey on Family. Specifically, we address the following research questions:

- What are the most common family sizes and types (e.g. married couple, single-parent, etc.)?
- Do most Canadians get married and how many children do they have?
- Are Canadian households mainly low-income, middle-income or high-income?
- Which provinces have the most immigrant families?
- Is religion important in Canadian families?
- What is the mental health of Canadians like, and what factors may be related to this?


# Data

## Data Source and Methodology

The data was obtained from Canada's 2017 General Social Survey (GSS) on the Family. The survey was conducted during the period of February 2nd to November 30th 2017 by computer assisted telephone interviews of participants. The target population was all non-institutionalized persons ages 15 years and older in Canada, excluding residents of the Yukon, Northwest Territories, and Nunavut. Participants were chosen using stratified sampling by geographic area within the 10 provinces, with one person representing each household to be interviewed. The response rate was 52.4% with a total of 20,602 respondents.

The age distribution of respondents is shown in figure \@ref(fig:agesrespondents).

```{r agesrespondents, echo=FALSE, message=FALSE, warning=FALSE, fig.cap="Distribution of Respondents' Ages"}

# add labels for 5-year age groups
five_year_groupings <- raw_data %>%
  mutate(age_group_5 = case_when(agegr5 == 1 ~ "15 to 19 years",
                                 agegr5 == 2 ~ "20 to 24 years",
                                 agegr5 == 3 ~ "25 to 29 years",
                                 agegr5 == 4 ~ "30 to 34 years",
                                 agegr5 == 5 ~ "35 to 39 years",
                                 agegr5 == 6 ~ "40 to 44 years",
                                 agegr5 == 7 ~ "45 to 49 years",
                                 agegr5 == 8 ~ "50 to 54 years",
                                 agegr5 == 9 ~ "55 to 59 years",
                                 agegr5 == 10 ~ "60 to 64 years",
                                 agegr5 == 11 ~ "65 to 69 years",
                                 agegr5 == 12 ~ "70 to 74 years",
                                 agegr5 == 13 ~ "75 to 79 years",
                                 agegr5 == 14 ~ "80 years and over"))

# Plot for total number of children
five_year_groupings %>%
  ggplot(aes(x = age_group_5)) +
  geom_bar() +
  # scale_y_continuous(breaks = seq(0, 7000, by = 1000)) +
  theme_minimal() +
  theme(panel.grid.major.x = element_blank(), panel.grid.minor.x = element_blank(),
        axis.text.x = element_text(angle = 50, hjust=1)) +
  labs(title = "Distribution of respondents' ages",
       x = "Five-year Age groups",
       y = "Number of responses")

```


Data collected by the GSS is categorized further into 2 components; core content and classification variables. Core content consists of data designed to measure social trends and living conditions, as well as to inform specific policy issues. Examples of core content include questions such as "Are parents satisfied with the child care services they are receiving?" and "How many parents are taking leave for the birth of their child?" Classification variables on the other hand refer to the variables used to collect the aforementioned socio-demographic data. These include age, sex, religion and education of the respondent, and are used to help accurately portray respondent populations, with the goal of helping in the analysis of core content. Below is a brief outline of the questionnaire content on the 2017 GSS on Family:

  - Entry component (respondent’s date of birth) 
  - Family origins 
  - Leaving the parental home 
  - Conjugal history 
  - Intentions and reasons to form a union 
  - Respondent’s children 
  - Fertility intentions 
  - Maternity/parental leave 
  - Organization and decision making within the household 
  - Arrangements and financial support after a separation/divorce 
  - Labour market new and education 
  - Health and subjective well-being 
  - Characteristics of respondent’s dwelling 
  - Characteristics of respondent of spouse/partner


## Survey Frame

As previously mentioned, participants of this survey were chosen via stratified sampling wherein each province was divided into strata. Most Census Metropolitan Areas (CMAs) were considered separate strata, while the remaining CMAs were grouped together and divided into 3 separate strata. In total there were 27 strata used for sampling. 

The survey frame was then created using 2 main components:
Lists of telephone numbers, both home lines and cellular, that were available to Statistics Canada, and
The Address Register (AR), a list of all the dwellings within the 10 provinces. 

One person was surveyed per household; thus the Address Register was used to group together phone numbers by address. Approximately 86% of telephone numbers were linked to an address via the AR. These numbers, as well as the remaining 14% of unlinked numbers, were then combined to create the sampling frame. When multiple phone numbers were linked to the same address, these numbers were then sorted by type of number, with landlines first and cellular numbers last. The first number was then considered the best number to reach that household; recall that we want to survey households, not individuals, and so landlines were prioritized over cellular numbers. Note that as a result of the cellular surveying method, households without a telephone were excluded from the survey frame. 


## Sampling Methods

Each phone number / group of phone numbers (which we will henceforth refer to as “records”) was then sorted into its corresponding geographical strata, at which point a simple random sample without replacement was then performed on each strata. Approximately 91.8% of telephone numbers selected in the sample reached an eligible household (an eligible household being defined as a household that included at least one person 15 years of age or older). Data on households that did not meet the eligibility requirements was not included in the results, and phone calls with such households were terminated. 


## Key features

The raw data includes 461 variables which were derived from the questionnaire responses. Some key features included age, sex, place of birth, marriage, ethnic diversity and immigration, education, work, income, children, religion, family structure, geographic location, household size and living arrangements. We used R [@citeR] and R packages tidyverse [@tidy] and janitor [@janitor] to clean the variable names and values. A subset of the key features is shown in table \@ref(tab:datafeatures).

```{r datafeatures, echo=FALSE, message=FALSE}
gss_data %>%
  select(age, total_children, sex, province, marital_status, income_family) %>%
  slice(1:10) %>%
  kable(
    caption = "Some key features",
    col.names = c("Age of respondent", "Total number of children", "Sex", "Province", "Marital Status", "Family Income"),
    digits = 1,
    booktabs = TRUE, 
    linesep = ""
  ) %>%
column_spec(1:2, width = "2.5cm")
```



## Strengths and weaknesses

```{r, include=FALSE}
# Check missing values
colSums(is.na(gss_data)) # https://stackoverflow.com/questions/24027605/determine-the-number-of-na-values-in-a-column
```

As with any statistical study, this survey has both strengths and weaknesses. Some of the strengths include the multitude of variables as well as the large sample size. Many variables provide ample opportunity for data exploration and research insights, while the large number of observations allow us to draw meaningful conclusions. One of the weaknesses of the survey is that the response categories for some of the survey questions were collapsed in the provided code; for example, 'mother tongue' only lists English, French and non-official languages, and 'race of respondent' was collapsed to visible minority (yes/no). In doing this, some data was lost, and as such we can make less inferences on the diversity of the responses.

# Results

```{r householdwrangling, include=FALSE, message=FALSE, warning=FALSE}
# Data wrangling for household
household_data <- raw_data %>%
  select(hsdsizec, famtype) %>%
  mutate(household_size = case_when(hsdsizec == 6 ~ "6+",
                                    TRUE ~ as.character(hsdsizec)), 
         family_type = case_when(famtype == 1 ~ "Couple",
                                 famtype == 2 ~ "Intact family*",
                                 famtype == 3 ~ "Step-family with common child",
                                 famtype == 4 ~ "Step-family without a common child",
                                 famtype == 5 ~ "Single-parent family",
                                 famtype == 6 ~ "No spouse/partner or children in the
household"))
# get percents of each household size
household_percents <- household_data %>%
  group_by(household_size) %>%
  summarise(percent = 100*n()/nrow(household_data))
# 5+ people in a houshold percentage
five_plus_households <- household_percents %>%
  filter(household_size >= 5) %>%
  select(percent) %>%
  summarise(total_percent = sum(percent))
```

## Household Size and Family Types

Figure \@ref(fig:householdsize) shows the distribution of Canadian households grouped by household size, based on what type of family they are. Note that an intact family refers to a now-married of common law couple, where all of the children have both parents, biological or adoptive, living in the household. Similarly, a step-family refers to such a couple where at least one of the children is in a step-relationship with at least one of the parents. Here we see that the majority of households consiste of only 1 or 2 people. From this we can infer that a large portion of Canadians either live alone or with either a partner or roommate. For household sizes greater than 2, the vast majority consist of intact families, with most families having 1 or 2 children. Only `r round(five_plus_households$total_percent, 2)`% of households have 5 or more people living together. 

```{r householdsize, echo=FALSE, message=FALSE, warning=FALSE, fig.cap="Distribution of Family Type by Household Size"}
# Plot for household size
household_data %>%
  ggplot(aes(x = household_size, fill = family_type)) +
  geom_bar() +
  scale_fill_brewer(palette = "Set1") +
  scale_y_continuous(breaks = seq(0, 8000, by = 1000)) +
  theme_minimal() +
  theme(panel.grid.major.x = element_blank(), panel.grid.minor.x = element_blank()) +
  labs(title = "Makeup of Canadian Families",
       x = "Household size",
       y = "Number of responses",
       fill = "Family Type",
       caption = "*Intact family = family in which both biological\nparents are present in the home.") +
  theme(plot.title = element_text(hjust = 0.5))
```

## Marriage and Children

```{r maritalstatus, echo=FALSE, message=FALSE, warning=FALSE, fig.cap="Distribution of marital status"}

# Data wrangling for marital status
marital_status_data <- gss_data %>%
  select(marital_status) %>% 
  add_count(marital_status) %>% 
  na.omit()

# Plot for marital status
marital_status_data %>%
  ggplot(aes(x = reorder(marital_status, n))) + # https://datavizpyr.com/re-ordering-bars-in-barplot-in-r/
  geom_bar(fill = "#4DAF4A") +
  theme_minimal() +
  theme(panel.grid.major.y = element_blank(), panel.grid.minor.y = element_blank(), 
        legend.position = "none") +
  labs(title = "Distribution of marital status",
       x = "Marital Status",
       y = "Number of responses") +
  scale_fill_brewer(palette = "Set1") +
  coord_flip()

```

```{r numchildrenwrangling, include=FALSE, message=FALSE, warning=FALSE}
# Data wrangling for total number of children
child_data <- gss_data %>%
  mutate(total_children1 = case_when(total_children == 7 ~ "7+",
                                     TRUE ~ as.character(total_children)
                                     ))
# get percents of each number
child_percents <- child_data %>%
  group_by(total_children1) %>%
  summarise(percent = 100*n()/nrow(child_data))
# 5+ people in a houshold percentage
zero_children <- child_percents %>%
  filter(total_children1 == 0) %>%
  select(percent) %>%
  summarise(total_percent = sum(percent))
```

Figure \@ref(fig:numchildren) shows the distribution of the total number of children per respondent. Note that this is not *per household* i.e. persons living together, but rather is the number of children had by the respondent of the household throughout their lifetime. Here we see that the majority of respondents either had 0 children or 2, with almost an identical number of respondents with 0 children as there are with 2. Similarly, the number of respondents with 1 child is very close to the number of those with 3. Thus, we note that about `r round(zero_children$total_percent,2)`%of Canadians do not have any children, and those who do usually have 1-3 children. 

```{r numchildren, echo=FALSE, message=FALSE, warning=FALSE, fig.height=3, fig.cap="Total Number of Children per Respondent"}
# Plot for total number of children
child_data %>%
  select(total_children1) %>%
  ggplot(aes(x = total_children1)) +
  geom_bar(fill = "#377EB8") +
  scale_y_continuous(breaks = seq(0, 7000, by = 1000)) +
  theme_minimal() +
  theme(panel.grid.major.x = element_blank(), panel.grid.minor.x = element_blank()) +
  labs(title = "Total Number of Children per Respondent",
       x = "Number of Children",
       y = "Number of Responses") +
  theme(plot.title = element_text(hjust = 0.5))
```


```{r agemarbirthwrangling, include=FALSE, message=FALSE, warning=FALSE}
have_children <- gss_data %>%
  filter(total_children > 0)
married_at_least_once <- gss_data %>%
  filter(marital_status != "Single, never married")
# Count the number of people who get married and don't have children
married_no_children <- gss_data %>%
  filter(marital_status != "Single, never married", total_children == 0) %>%
  summarise(n = n()/nrow(married_at_least_once))
  
# Count the number of people who have children and don't get married
children_no_married <- gss_data %>%
  filter(marital_status == "Single, never married", total_children > 0) %>%
  summarise(n = n()/nrow(have_children))
# Count the number of people who neither get married nor have children
```


Figure \@ref(fig:agemarbirth) graphs the distributions of the age of respondents when they first got married and when they first had children, as well as the number of years between their first marriage and their first child. For first marriage, the majority of responses lie between 20-30 years, with a peak at around 21 years. For first birth, the bulk of responses were between 20 and 35 years of age, with the peak at 25 years. Notably, the distribution is almost uniform between 20 and 30 years. The distributions for first marriage and first child are both are right-skewed. This is to be expected, as the likelihood of getting married would intuitively increase drastically as one approaches 20, and drop off gradually past 30. A similar trend is to be expected with first birthes, as women first become fertile around puberty, and generally reach menopause at 45-50 years [(National Institute on Aging, 2021)](https://www.nia.nih.gov/health/what-menopause).

`r round(100 *married_no_children$n, 2)`% of people who were ever married do not have any children, and `r round(100 *children_no_married$n, 2)`% of people who have children were never married. For those persons who get married and have kids, plot A of Figure \@ref(fig:agemarbirth) shows that the majority of Canadians bear children within the first 10 years of their first marriage, with by far the most married births occurring within 1 year of marriage.

```{r agemarbirth, echo=FALSE, message=FALSE, warning=FALSE, fig.cap="Distribution of Ages at Marriage and Birth"}
# Plot for age at first marriage
marriage_plot<- gss_data %>%
  mutate(age_at_first_marriage = floor(age_at_first_marriage)) %>%
  select(age_at_first_marriage) %>%
  ggplot(aes(x = age_at_first_marriage)) +
  geom_bar(width = 0.95, fill = "#E41A1C") +
  scale_x_continuous(limits = c(15, 50), breaks = c(15, seq(0, 50, by = 10))) +
  scale_y_continuous(limits = c(0, 1000),breaks = seq(0, 1000, by = 200)) +
  theme_minimal() +
  theme(panel.grid.major.x = element_blank(), panel.grid.minor.x = element_blank()) +
  labs(title = "B. Distribution of Age at First\n    Marriage",
       x = "Age at First Marriage",
       y = "")
# Plot for age at first birth
first_birth_plot <- gss_data %>%
  mutate(age_at_first_birth = floor(age_at_first_birth)) %>%
  select(age_at_first_birth) %>%
  ggplot(aes(x = age_at_first_birth)) +
  geom_bar(widh = 0.95, fill = "#4DAF4A") +
  scale_x_continuous(limits = c(15, 50), breaks = c(18, 45, seq(0, 50, by = 10))) +
  scale_y_continuous(limits = c(0, 1000),breaks = seq(0, 1000, by = 200)) +
  theme_minimal() +
  theme(panel.grid.major.x = element_blank(), panel.grid.minor.x = element_blank()) +
  labs(title = "C. Distribution of Age at First Birth",
       x = "Age at First Birth",
       y = "")
# Plot years between marriage and birth
mar_and_birth <- gss_data %>% 
  mutate(age_at_first_marriage = floor(age_at_first_marriage), 
         age_at_first_birth = floor(age_at_first_birth)) %>% 
  mutate(years_btwn_mar_birth = age_at_first_birth - age_at_first_marriage) %>%
  group_by(years_btwn_mar_birth) %>% 
  summarise(n = n()) 
mar_birth_plot <- mar_and_birth %>%
  ggplot(aes(x = years_btwn_mar_birth, y = n)) + 
  geom_bar(stat = "identity", width = 0.95, fill = "#984EA3") +
  scale_x_continuous(limits = c(-29, 26),
                     breaks = seq(-30, 25, by = 5)) +
  scale_y_continuous(limits = c(0, 1100),breaks = seq(0, 1100, by = 100)) +
  theme_minimal() +
  theme(panel.grid.major.x = element_blank(), panel.grid.minor.x = element_blank()) +
  labs(title = "A. Distribution of Years between\n    Marriage and Birth",
       x = "Age at First Birth - Age at First Marriage",
       y = "Number of Responses")
mar_birth_plot + (marriage_plot / first_birth_plot)
```

## Place of Birth and Immigration

```{r placeofbirthwrangling, echo=FALSE, message=FALSE, warning=FALSE}
# number of people born in Canada
num_people_born_in_canada <- gss_data %>%
  filter(place_birth_canada == "Born in Canada") %>%
  summarise(n = n()/nrow(gss_data))
```

Figure \@ref(fig:placeofbirth) shows the distribution of respondent's province of birth, as well as distribution of respondents' parents' birth place, the latter distribution only looking at whether the parents were born inside or outside of Canada. Although `r 100*round(num_people_born_in_canada$n,2)`% of Canadians in our sample were born in Canada, the number of individuals born outside Canada is greater than the number of individuals born in any individual province. As expected, the vast majority of these persons' parents were also born outside of Canada. Within Canada, the most common provinces of birth are Ontario and Quebec. Notably, despite a similar number of respondents being born in Ontario and Quebec, respondents born in Ontario are more than twice as likely to have one or more parents born outside of Canada. 

The provinces with the largest population of [second generation](https://www23.statcan.gc.ca/imdb/p3VD.pl?Function=getVD&TVD=117200&CVD=117200&CLV=0&MLV=1&D=1) Canadians--defined as a person born in Canada with one or more parents born outside Canada--are Ontario, British Colombia, Quebec, Alberta, Saskatchewan and Manitoba. In figure \@ref(fig:maplocation), we see that first generation Canadians--defined as a person with both parents born outside Canada) mainly settled in the same provinces as the second generation immigrants. Notably, provinces on the east coast such as Nova Scotia and New Brunswick are almost entirely comprised of third generation Canadians, or Canadians born in Canada with both parents also born in Canada. 

```{r placeofbirth, echo=FALSE, message=FALSE, warning=FALSE, fig.cap="Distribution of Persons by Place of Birth"}
# Data wrangling for place of birth
birth_place_data <- gss_data %>%
  select(place_birth_canada, place_birth_father, place_birth_mother, place_birth_province) %>%
  mutate(place_birth_parent = case_when(place_birth_father == "Born outside Canada" & place_birth_mother == "Born outside Canada" ~ "Both born outside Canada",
                                        place_birth_father == "Born outside Canada" | place_birth_mother == "Born outside Canada" ~ "One born outside Canada",
                                        place_birth_father == "Born in Canada" & place_birth_mother == "Born in Canada" ~ "Both born in Canada",
                                        TRUE ~ "NA"),
         place_birth_province = case_when(place_birth_canada == "Born outside Canada" ~ "Outside Canada",
                                          TRUE ~ place_birth_province)
         ) %>%
  mutate(place_birth_parent = factor(place_birth_parent, levels = c("Both born in Canada", "One born outside Canada", "Both born outside Canada", "NA"))) %>%
  add_count(place_birth_province) %>% 
  na.omit()
birth_place_data <- birth_place_data %>%
  mutate(place_birth_province = str_replace(place_birth_province, "Northwest", "NW"))
  
# Plot for place of birth
birth_place_data %>%
  ggplot(aes(x = reorder(place_birth_province, n), fill = place_birth_parent)) + # https://datavizpyr.com/re-ordering-bars-in-barplot-in-r/
  geom_bar() +
  scale_y_continuous(limits = c(0, 4500), breaks = seq(0, 4500, by = 1000)) +
  scale_fill_brewer(palette = "Set1") +
  theme_minimal() +
  theme(panel.grid.major.y = element_blank(), 
        panel.grid.minor.y = element_blank(), 
        legend.position = "bottom", legend.key.width = unit(5, "mm")) +
  guides(fill=guide_legend(nrow=2, byrow=TRUE)) + # https://datavizpyr.com/fold-legend-into-two-rows-in-ggplot2/
  labs(x = "Place of Birth",
       y = "Number of Responses",
       fill = "Birth Place\nof Parents") +
  coord_flip()
```


```{r maplocation, echo=FALSE, message=FALSE, warning=FALSE, fig.cap="Distribution of Immigrants Currently Residing in Canada by Province"}
immigrant_settled <- gss_data %>%
  filter(place_birth_canada == "Born outside Canada", place_birth_father == "Born outside Canada", place_birth_mother == "Born outside Canada") %>%
  group_by(province) %>%
  summarise(n = n())
# Code from https://cran.r-project.org/web/packages/mapcan/vignettes/choropleth_maps_vignette.html
pr_geographic <- mapcan(boundaries = province,
       type = standard)
pr_geographic <- full_join(pr_geographic, 
           immigrant_settled, 
           by = c("pr_english" = "province")) %>%
  mutate(n = replace_na(n, 0))
# graph labels
map_labels <- pr_geographic %>%
  group_by(pr_english) %>%
  summarise(mid_lat = mean(lat), mid_long = mean(long))
# fix position of certain labels #https://stackoverflow.com/questions/14782206/how-do-i-change-a-single-value-in-a-data-frame
map_labels[1, 3] = map_labels[1, 3] + 250000
map_labels[2, 3] = map_labels[2, 3] + 250000
map_labels[12, 3] = map_labels[12, 3] - 150000
map_labels[1, 2] = map_labels[1, 2] + 250000
map_labels[9, 2] = map_labels[9, 2] + 250000
map_labels[11, 3] = map_labels[11, 3] - 250000
pr_geographic <- inner_join(pr_geographic, map_labels, by = "pr_english")
# plot map
pr_geographic %>%
  ggplot(aes(x = long, y = lat, group = group, fill = n)) +
  geom_polygon() +
  coord_fixed() +
  theme_mapcan() +
  scale_fill_viridis_c(name = "Number of Immigrants") +
  geom_text(aes(label = pr_alpha, x = mid_long, y = mid_lat))
```

Figure \@ref(fig:immigrantsarrival) shows the years that respondents who were born outside of Canada reported arriving in Canada, as well as where they hailed from. Notably the population of Europeans made up the largest proportion of immigrants and was at its largest amount during the period 1946-1959, but then decreased to almost a constant number from about 1970 onwards. In contrast, the population of Asian immigrants has been increasing steadily up to 2014 and it has comprised the largest subsection of immigrants since about 1985. The number of immigrants from Africa and the Americas has not changed too significantly, but the years 2000-2014 saw a boom in immigration from these groups together with Asian immigrants.

```{r immigrantsarrival, echo=FALSE, message=FALSE, warning=FALSE, fig.cap="Distribution of Immigrants' Continent of Origin by Year"}
country_origin <- gss_data %>%
  filter(place_birth_canada == "Born outside Canada") %>%
  select(place_birth_macro_region, year_arrived_canada) %>%
  mutate(year_arrived_canada = str_remove(year_arrived_canada, "Arrived between ")) %>%
  mutate(year_arrived_canada = fct_relevel(year_arrived_canada, "Arrived before 1946", after = 0))
country_origin %>%
  ggplot(aes(x = year_arrived_canada, fill = place_birth_macro_region)) +
  geom_bar() +
  scale_y_continuous(limits = c(0, 600), breaks = seq(0, 600, by = 100)) +
  scale_fill_brewer(palette = "Set1") +
  theme_minimal() +
  theme(panel.grid.major.x = element_blank(), 
        panel.grid.minor.x = element_blank(),
        axis.text.x = element_text(angle = 50, hjust=1)) + # https://stackoverflow.com/questions/1330989/rotating-and-spacing-axis-labels-in-ggplot2
  labs(x = "Year Arrived in Canada",
       y = "Number of Responses",
       fill = "Continent of Origin")
```

```{r langspoken, echo=FALSE, message=FALSE, warning=FALSE, fig.cap="Distribution of languages by province"}

# Data wrangling for lang spoken
lang_spoke_data <- gss_data %>%
  select(language_home, province) %>% 
  add_count(language_home) %>% 
  na.omit()

# Plot for lang spoken
lang_spoke_data %>%
  ggplot(aes(x = reorder(province, n), fill = language_home)) + # https://datavizpyr.com/re-ordering-bars-in-barplot-in-r/
  geom_bar() +
  theme_minimal() +
  theme(panel.grid.major.y = element_blank(), panel.grid.minor.y = element_blank()) +
  labs(title = "Distribution of language spoken in household between provinces",
       x = "Province",
       y = "Number of responses",
       fill = "Language spoken in household") +
  scale_fill_brewer(palette = "Set1") +
  coord_flip()
```


## Family Income


```{r income, echo=FALSE, message=FALSE, warning=FALSE, fig.cap="Distribution of Income"}

# Data wrangling for income
income_data <- gss_data %>%
  select(income_family, hh_size) %>%
  mutate(income_family = factor(income_family, levels = c("Less than $25,000", "$25,000 to $49,999", 
                                                          "$50,000 to $74,999", 
                                                          "$75,000 to $99,999", 
                                                          "$100,000 to $ 124,999", 
                                                          "$125,000 and more")),
         hh_size = as.factor(hh_size)) %>% 
  add_count(income_family) %>% 
  na.omit()

# Plot for income
income_data %>%
  ggplot(aes(x = income_family, fill = hh_size)) + # https://datavizpyr.com/re-ordering-bars-in-barplot-in-r/
  geom_bar() +
  theme_minimal() +
  theme(panel.grid.major.y = element_blank(), panel.grid.minor.y = element_blank()) +
  labs(title = "Distribution of Family Income for Various Household Sizes",
       x = "Family Income",
       y = "Number of Responses",
       fill = "Household Size") +
  scale_fill_brewer(palette = "Set1") +
  coord_flip()

```

```{r hoursworked, echo=FALSE, message=FALSE, warning=FALSE, fig.cap="Distribution of Hours Worked"}

# Data wrangling for hours worked
hrs_worked_data <- gss_data %>%
  select(average_hours_worked) %>% 
  add_count(average_hours_worked) %>% 
  na.omit()

# we can maybe look at hrs worked for a subset of the population i.e.
# location like "plot for place of birth"?
# Plot for hours worked
hrs_worked_data %>%
  ggplot(aes(x = average_hours_worked)) + # https://datavizpyr.com/re-ordering-bars-in-barplot-in-r/
  geom_bar() +
  theme_minimal() +
  theme(panel.grid.major.y = element_blank(), panel.grid.minor.y = element_blank(), 
        legend.position = "none") +
  labs(title = "Distribution of Average Number of Hours Worked per Week",
       x = "Average Number of Hours Worked per Week",
       y = "Number of Responses") +
  scale_fill_brewer(palette = "Set1") +
  coord_flip()

```

## Religion

```{r religion, echo=FALSE, message=FALSE, warning=FALSE, fig.cap="Distribution of Religion"}

# Data wrangling for religion
religion_data <- gss_data %>%
  select(regilion_importance) %>% 
  add_count(regilion_importance) %>% 
  na.omit()

# we can maybe look at religion importance for a subset of the population i.e.
# location like "plot for place of birth"?
# Plot for religion
religion_data %>%
  ggplot(aes(x = reorder(regilion_importance, n), fill = regilion_importance)) + # https://datavizpyr.com/re-ordering-bars-in-barplot-in-r/
  geom_bar() +
  theme_minimal() +
  theme(panel.grid.major.y = element_blank(), panel.grid.minor.y = element_blank(), 
        legend.position = "none") +
  labs(title = "Distribution of Religion Importance",
       x = "Religion Importance",
       y = "Number of Responses") +
  scale_fill_brewer(palette = "Set1") +
  coord_flip()

```

## Mental Health

```{r mentalhealth, echo=FALSE, message=FALSE, warning=FALSE, fig.cap="Distribution of Mental Health"}

# Data wrangling for mental health
mental_health_data <- gss_data %>%
  select(self_rated_mental_health, age) %>% 
  mutate(self_rated_mental_health = factor(self_rated_mental_health, 
                                           levels = c("Don't know", "Poor", "Fair",
                                                      "Good", "Very good", "Excellent")),
         age_grp = case_when(age < 20 ~ "< 20",
                             age >= 20 & age < 30 ~ "20-30",
                             age >= 30 & age < 40 ~ "30-40",
                             age >= 40 & age < 50 ~ "40-50",
                             age >= 50 & age < 60 ~ "50-60",
                             age >= 60 & age < 70 ~ "60-70",
                             age >= 70 & age < 80 ~ "70-80",
                             age >= 80 ~ ">= 80")) %>% 
  add_count(self_rated_mental_health) %>% 
  na.omit()

# Plot for mental health
mental_health_data %>%
  ggplot(aes(x = self_rated_mental_health, fill = age_grp)) + # https://datavizpyr.com/re-ordering-bars-in-barplot-in-r/
  geom_bar() +
  theme_minimal() +
  theme(panel.grid.major.y = element_blank(), panel.grid.minor.y = element_blank()) +
  labs(title = "Distribution of Self Rated Mental Health",
       x = "Self Rated Mental Health",
       y = "Number of Responses", 
       fill = "Age groups") +
  scale_fill_brewer(palette = "Set1") +
  coord_flip()

```
\newpage

# Discussion

## Mental Health

The topic of the Canadian General Social Survey in 2017 was family; it aimed to capture as much information as possible about the structure of Canadian families, with the goal of understanding and monitoring the evolution of families over time. This information can then be used to guide social and fiscal policies so that they may best serve the current needs and wants of Canadian families. As well, the survey provides a glimpse at how well current policies are serving Canadians. For example, question SRH_Q115 asked "In general, would you say your mental health is...?" with respondents choosing one of "Don't Know, Poor, Fair, Good, Very Good and Excellent". The distribution of these responses is exhibited in Figure (insert the abt mental health). Very notably, the vast majority of respondents rated their mental health as "Good", "Very Good" or "Excellent", with an exceedingly small proportion of people answer "Poor". As well, Figure (insert the abt mental health) also shows the distribution of the age of respondents for each answer, in which we see nearly identical proportions of people of all age groups for each answer. This means that not only are Canadians happy in general, but also that this happiness is not skewed towards certain age groups, as we had originally hypothesized. It must be made note of that this survey was conducted in 2017 and thus conducted pre-pandemic. As such, this graph likely does not provide us with an accurate picture of the current sentiments of Canadians. As well, by virtue of the survey not being mandatory for chosen respondents to complete, there is likely an intrinsic sampling bias towards people with better mental health; some of the defining symptoms of poor mental health include tiredness, lack of energy and a lack of initiative. As such, people with poor mental health would be inherently less likely to voluntarily complete a survey. 


## Family Planning

Canada has always been committed to having strong family planning and sexual and reproductive health (SRH) services. In 2017, Global Affairs Canada -- a branch of the Canadian government -- dedicated CA$650 million over the next 3 years towards promoting the sexual and reproductive health and rights of women and girls (cite). In 2015, Canada committed CA\$3.5 billion towards maternal, newborn and child health, including improving SRH services and information. This strong foothold in the realm of family planning is reflected in this survey in a number of ways. For example, Figure \@ref(fig:householdsize) showcases the distribution of the size of Canadian households, broken down by what type of family lives in that household. Here we see that the majority of households only consist of 1 or 2 people, followed by households containing 3 or 4 people, of which there were a very similar amount. Notably, there is a steep drop-off in frequency of households larger than 4 people, with about a third as many 5-person households as there are 3 or 4-person, and less than a sixth as many households containing 6 or more people. This is likely a reflection of Canada's ample family planning resources leading couples more likely to opt for 1 or 2 children, thus keeping the average household size low. Figure \@ref(fig:numchildren) shows the distribution of the total number of children had by respondents. Interestingly, we see that by far the most frequent responses are 0 children and 2 children, of which there were a nearly identical number of responses. This means that once a couple has one child, they are then more likely to opt to have another child. This seemingly conflicts with Figure \@ref(fig:householdsize), which showed that 3-person households were just as common as 4-person households. There could be a couple reasons for these seemingly disjoint results. The firstly, relative to the general population, a high proportion of elderly people were surveyed. As elderly people are unlikely to still be living with their children, this would naturally lower the average household size without affecting the average number of children. As well, members of the same household are not necessarily parents or children, nor even family members. For example, a small proportion of 3-person households consist of couples. As these households are classified as couples and not intact families, this entails that the 3rd member of the household is not one of the couple's children. In Figure \@ref(fig:householdsize) we also see that aside from 0 and 2, 1 and 3 are both by far the next most common responses, with about 2900 respondents having 1 child and 3200 having 3. This also goes to show that Canada's continued investments into SRH and family planning services have been effective in keeping reproductive rates healthy and sustainable on both an individual and aggregate level. 


## Immigration

Canada has a strong track record when it comes to immigration, boasting one of the highest naturalization rates in the world, with about 85% of newcomers eventually becoming citizens. Figure \@ref(fig:placeofbirth) shows the distribution of the birth place of the respondents parents, grouped by the respondent's province or territory of birth. Here we see that for respondents born in Canada, Ontario has by far the greatest amount of second generation Canadians, with about 30% of Canadians born in Ontario having at least one parent born outside of Canada. British Columbia has a similarly high proportion of second generation Canadians, followed by Alberta, Manitoba and Saskatchewan, each of which has a similar proportion. This is to be expected, as the 2 main hotbeds of immigration in Canada, Toronto and Vancouver, are the capital cities of Ontario and BC respectively. Notably, provinces on the east coast such as New Brunswick, Newfoundland, Nova Scotia and Prince Edward Island all have exceedingly low rates of immigration. While there could be cultural and societal causes for this lack of Atlantic immigration, the most obvious cause would be the general rurality of the provinces; in general, immigrants tend to settle down in urban areas, largely due to the economic and societal opportunities that present themselves in big cities. This is evident in Canada, where immigrants flock to large urban centers such as Toronto, Vancouver and Montreal. Provinces on the Atlantic are far less urbanized than Ontario or BC, and as such immigrants are less likely to settle down in them. Figure \@ref(fig:maplocation) shows a density map of where immigrants currently reside in Canada, supplementing the previous figure. Here we again see that Ontario has by far the most immigrants of any province, followed by British Columbia. It's worth noting that this map only shows the number of immigrants residing in each province, as opposed to the proportion. So while Ontario has far more immigrants than BC, they in fact have a similar proportion of immigrants in their population. Figure \@ref(fig:immigrantsarrival) shows how many immigrants arrived in Canada over 5 year periods since 1946, as well as which continent they were immigrating from. Here we see a sharp increase in the number of immigrants arriving in Canada since 2000, with that number continuing to trend upwards. This coincides with the ongoing efforts by the Canadian government to drive immigration rates up, which is one of the key ways that Canada aims to combat the economic decline driven by its aging population. Increasing immigration rates allows for a new inflow of young and eligible workers into the country, bolstering Canada's workforce and stimulating the economy. Another noticeable trend shown in Figure \@ref(fig:immigrantsarrival) is the increasing rate at which immigrants are hailing from Asia, which has been increasing continuously since 1964 but most noticeably exploded in the early 1980s. This increase coincides with the Early 1980s Recession experienced by Canada, as well as the drastic economic growth China began to experience in the early 1980s and continue to today. Other trends include the increasing rate of African immigrants, and the decreasing rate of European immigrants, with European immigrants making up the smallest proportion of immigrants since 2010. Despite the proportion of European immigrants decreasing, the actual number of European immigrant respondents has remained steady since 1975, meaning that this drop in proportion is more likely related to the drastically increasing amount of Asian immigrants than it is a decreasing propensity for Europeans to immigrate to Canada.


## Weaknesses and Next Steps

There are some weaknesses in our paper that we will discuss. First off, we did not collect the data that we are making inferences from ourselves, and as such, we only know as much about the methodology behind it as we've been told. While this certainly could have been a more substantial issue, Statistics Canada did more than their due diligence in providing information about every aspect of the survey, explaining the sampling procedures and survey methodologies in depth, as well as providing a 264 page codebook explaining every variable in depth, as well as the corresponding question. As such, this is more of an ethical weakness than a practical one. However, there could be biases unaccounted for by Statistics Canada, or other failures in the sampling or surveying process, ethical or otherwise, and we could not know about them. Another possible weakness in our paper is our extensive data cleaning process, wherein we quite literally filtered out hundreds of variables, only keeping the ones we deemed statistically relevant to our paper. In doing so, we sacrificed some of the context that those variables could have lent to the ones we selected. However, this falls back to the ethical question of whether or not data should be left to speak for itself; we opted to extensively clean and filter the data so as to make it as interpretable as possible, but in doing so we did lose information that could have changed our interpretations of the data. As well, some of the variables we filtered out were related to some of the variables that we included, and as such would have almost certainly provided additional context to our graphs and figures. Despite this loss of context, due to the multitude of variables in the data, this was a sacrifice we deemed worthwhile for the overall interpretability of our paper, as well as to avoid wrangling 50+ variables. The final shortcoming of our paper is that we did not end up conclusively answering all of our research questions. For example, while the data we collected seems to conclusively state that the mental health of Canadians is very good, as previously mentioned there are some inherent biases in the sampling method that make people with poor mental health less likely to take the time and effort to complete the survey, skewing our results. As well, there was a general lack of questions regarding mental health, and as such we were limited in what conclusions we could draw. We account for this lack of questions about mental health in our supplementary survey, which was designed with our research questions in mind. As well, even though we didn't conclusively answer all of our research questions as we had hoped, we still answered the majority of them, if not conclusively than the very least satisfactorily.


\newpage

\appendix

# Appendix {-}


# Additional details


\newpage


# References

